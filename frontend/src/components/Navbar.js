import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from "react/jsx-runtime";
// Navbar com layout responsivo, separando navegação padrão e atalhos de admin
import { useState, useEffect } from 'react';
import { Link, NavLink, useLocation, useNavigate } from 'react-router-dom';
import { useAuth } from '@/contexts/AuthContext';
import { useCart } from '@/contexts/CartContext';
import { Home, UtensilsCrossed, ShoppingBag, Info, User, LogOut, Menu, X, Shield } from 'lucide-react';
export function Navbar() {
    const { token, user, logout } = useAuth();
    const navigate = useNavigate();
    const location = useLocation();
    const { items } = useCart();
    const cartCount = items.reduce((acc, i) => acc + i.quantity, 0);
    const isAdmin = !!user && (user.role === 'ADMIN' || user.role === 'ROOT');
    // estado do menu mobile
    const [open, setOpen] = useState(false);
    useEffect(() => {
        // fecha o menu quando a rota mudar
        setOpen(false);
    }, [location.pathname]);
    function handleLogout() {
        logout();
        navigate('/');
    }
    return (_jsxs("header", { className: "sticky top-0 z-50 bg-white/80 backdrop-blur shadow", children: [_jsxs("div", { className: "max-w-6xl mx-auto px-4 py-3 flex items-center justify-between", children: [_jsxs("div", { className: "flex items-center min-w-0", children: [_jsxs(Link, { to: "/", className: "text-2xl font-bold whitespace-nowrap", children: [_jsx("span", { className: "text-tertiary", children: "UAI" }), _jsx("span", { className: "text-yellow-500", children: "Food" })] }), _jsxs("nav", { className: "hidden md:flex items-center gap-4 text-sm ml-6", children: [_jsxs(NavLink, { to: "/", className: ({ isActive }) => `inline-flex items-center gap-1 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700 hover:text-tertiary'}`, children: [_jsx(Home, { size: 16 }), " In\u00EDcio"] }), _jsxs(NavLink, { to: "/cardapio", className: ({ isActive }) => `inline-flex items-center gap-1 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700 hover:text-tertiary'}`, children: [_jsx(UtensilsCrossed, { size: 16 }), " Card\u00E1pio"] }), _jsxs(NavLink, { to: "/sobre", className: ({ isActive }) => `inline-flex items-center gap-1 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700 hover:text-tertiary'}`, children: [_jsx(Info, { size: 16 }), " Sobre"] }), _jsxs(NavLink, { to: "/carrinho", className: ({ isActive }) => `inline-flex items-center gap-1 relative ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700 hover:text-tertiary'}`, children: [_jsx(ShoppingBag, { size: 16 }), " Carrinho", cartCount > 0 && (_jsx("span", { className: "absolute -top-2 -right-3 text-[11px] bg-red-500 text-white px-1.5 py-0.5 rounded-full", children: cartCount }))] })] })] }), _jsx("div", { className: "hidden md:flex items-center gap-3 text-sm", children: token ? (_jsxs(_Fragment, { children: [isAdmin && (_jsx("div", { className: "flex items-center gap-3 pr-3 mr-1 border-r", children: _jsx(NavLink, { to: "/admin", className: ({ isActive }) => `inline-flex items-center gap-1 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700 hover:text-tertiary'}`, children: _jsx(Shield, { size: 16 }) }) })), _jsxs(NavLink, { to: "/perfil", className: ({ isActive }) => `inline-flex items-center gap-1 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700 hover:text-tertiary'}`, children: [_jsx(User, { size: 16 }), " ", user?.name ? `Olá, ${user.name.split(' ')[0]}` : 'Perfil'] }), _jsxs("button", { onClick: handleLogout, className: "px-3 py-1 rounded border border-red-500 text-red-600 hover:bg-red-50 inline-flex items-center gap-1", children: [_jsx(LogOut, { size: 16 }), " Sair"] })] })) : (_jsxs(_Fragment, { children: [_jsxs(NavLink, { to: "/login", className: ({ isActive }) => `inline-flex items-center gap-1 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700 hover:text-tertiary'}`, children: [_jsx(User, { size: 16 }), " Entrar"] }), _jsx(NavLink, { to: "/cadastro", className: "px-3 py-1 rounded bg-gradient-to-r from-yellow-400 to-red-500 text-white", children: "Cadastrar" })] })) }), _jsx("button", { className: "md:hidden inline-flex items-center justify-center h-10 w-10 rounded hover:bg-gray-100", "aria-label": "Abrir menu", "aria-expanded": open, onClick: () => setOpen((v) => !v), children: open ? _jsx(X, { size: 20 }) : _jsx(Menu, { size: 20 }) })] }), open && (_jsx("div", { className: "md:hidden border-t bg-white", children: _jsxs("div", { className: "max-w-6xl mx-auto px-4 py-3 grid gap-3 text-sm", children: [_jsxs("div", { className: "flex flex-col gap-2", children: [_jsxs(NavLink, { to: "/", className: ({ isActive }) => `inline-flex items-center gap-2 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700'}`, children: [_jsx(Home, { size: 18 }), " In\u00EDcio"] }), _jsxs(NavLink, { to: "/cardapio", className: ({ isActive }) => `inline-flex items-center gap-2 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700'}`, children: [_jsx(UtensilsCrossed, { size: 18 }), " Card\u00E1pio"] }), _jsxs(NavLink, { to: "/sobre", className: ({ isActive }) => `inline-flex items-center gap-2 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700'}`, children: [_jsx(Info, { size: 18 }), " Sobre"] }), _jsxs(NavLink, { to: "/carrinho", className: ({ isActive }) => `inline-flex items-center gap-2 relative ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700'}`, children: [_jsx(ShoppingBag, { size: 18 }), " Carrinho", cartCount > 0 && (_jsx("span", { className: "ml-auto text-[11px] bg-red-500 text-white px-1.5 py-0.5 rounded-full", children: cartCount }))] })] }), token && isAdmin && (_jsx("div", { className: "pt-2 border-t flex flex-col gap-2", children: _jsxs(NavLink, { to: "/admin", className: ({ isActive }) => `inline-flex items-center gap-2 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700'}`, children: [_jsx(Shield, { size: 18 }), " Administra\u00E7\u00E3o"] }) })), _jsx("div", { className: "pt-2 border-t flex items-center justify-between gap-2", children: token ? (_jsxs(_Fragment, { children: [_jsxs(NavLink, { to: "/perfil", className: ({ isActive }) => `inline-flex items-center gap-2 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700'}`, children: [_jsx(User, { size: 18 }), " ", user?.name ? `Olá, ${user.name.split(' ')[0]}` : 'Perfil'] }), _jsxs("button", { onClick: handleLogout, className: "px-3 py-1 rounded border border-red-500 text-red-600 hover:bg-red-50 inline-flex items-center gap-1", children: [_jsx(LogOut, { size: 16 }), " Sair"] })] })) : (_jsxs(_Fragment, { children: [_jsxs(NavLink, { to: "/login", className: ({ isActive }) => `inline-flex items-center gap-2 ${isActive ? 'text-tertiary font-semibold' : 'text-gray-700'}`, children: [_jsx(User, { size: 18 }), " Entrar"] }), _jsx(NavLink, { to: "/cadastro", className: "px-3 py-1 rounded bg-gradient-to-r from-yellow-400 to-red-500 text-white", children: "Cadastrar" })] })) })] }) }))] }));
}
